ArticleEditor.add("plugin","counter",{translations:{en:{counter:{words:"words",chars:"chars"}}},subscribe:{"editor.change":function(){this._count()}},start:function(){this._count()},_count:function(){var t=0,a=0,r=0,s=this.app.$element.val();if(""!==(s=this._clean(s))){var e=s.split(/\s+/),c=s.match(/\s/g);t=e?e.length:0,r=c?c.length:0,a=s.replace(/\s+/g," ").length}var n={words:t,characters:a,spaces:r};this.app.broadcast("counter.count",n),this.app.statusbar.add("words",this.lang.get("counter.words")+": "+n.words),this.app.statusbar.add("chars",this.lang.get("counter.chars")+": "+n.characters)},_clean:function(t){return t=(t=(t=(t=(t=(t=t.replace(/<\/(.*?)>/gi," ")).replace(/<(.*?)>/gi,"")).replace(/\t/gi,"")).replace(/\n|\r/gi," ")).replace(/&nbsp;/g,"1")).trim(),t=this.app.utils.removeInvisibleChars(t)}});